üìñ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Unity + Node.js Backend (SQLite)
üîß –û–±—â–∞—è –ª–æ–≥–∏–∫–∞

Unity-–∫–ª–∏–µ–Ω—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å —Å–µ—Ä–≤–µ—Ä–æ–º —á–µ—Ä–µ–∑ HTTP-API:

/login ‚Äî –≤—Ö–æ–¥ –ø–æ –ª–æ–≥–∏–Ω—É –∏ –ø–∞—Ä–æ–ª—é, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–∫–µ–Ω (JWT).

/users/me ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏—Ü–µ–Ω–∑–∏–∏ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ.

–¢–æ–∫–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ ApiClient –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤–æ –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã.
–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ ‚Äî –ø–µ—Ä–µ—Ö–æ–¥ –≤ –∞—Ä–µ–Ω—É, –µ—Å–ª–∏ –ª–∏—Ü–µ–Ω–∑–∏—è –∞–∫—Ç–∏–≤–Ω–∞.

üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –≤ Unity
Assets/
 ‚îî‚îÄ‚îÄ Scripts/
      ‚îî‚îÄ‚îÄ Backend/
           ‚îú‚îÄ‚îÄ ApiClient.cs       // –æ–±—â–∏–π –∫–ª–∏–µ–Ω—Ç API
           ‚îú‚îÄ‚îÄ LoginManager.cs    // –ª–æ–≥–∏–∫–∞ –≤—Ö–æ–¥–∞
           ‚îú‚îÄ‚îÄ GameManager.cs     // –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏—Ü–µ–Ω–∑–∏–∏

üìå –°–∫—Ä–∏–ø—Ç—ã
1. ApiClient.cs

–°–∏–Ω–≥–ª—Ç–æ–Ω, –∂–∏–≤—ë—Ç –º–µ–∂–¥—É —Å—Ü–µ–Ω–∞–º–∏ (DontDestroyOnLoad).

–°–æ–¥–µ—Ä–∂–∏—Ç –±–∞–∑–æ–≤—ã–π URL (http://ip-—Å–µ—Ä–≤–µ—Ä–∞:3000).

–ú–µ—Ç–æ–¥—ã:

Post(endpoint, json, callback) ‚Äî POST-–∑–∞–ø—Ä–æ—Å.

Get(endpoint, callback) ‚Äî GET-–∑–∞–ø—Ä–æ—Å.

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç Authorization: Bearer <token>.

–ß—Ç–æ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å: –∑–∞–º–µ–Ω–∏—Ç—å http://localhost:3000 –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π IP/–¥–æ–º–µ–Ω —Å–µ—Ä–≤–µ—Ä–∞.

2. LoginManager.cs

–°–∫—Ä–∏–ø—Ç –≤–∏—Å–∏—Ç –Ω–∞ LoginScene.

UI:

TMP_InputField usernameField

TMP_InputField passwordField

TMP_Text resultText

–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ –í–æ–π—Ç–∏ –≤—ã–∑—ã–≤–∞–µ—Ç /login.

–ï—Å–ª–∏ —É—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥:

—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ–∫–µ–Ω –≤ ApiClient.

–∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å—Ü–µ–Ω—É ArenaLoaderScene.

–ï—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Äî –ø–∏—à–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

3. GameManager.cs

–°–∫—Ä–∏–ø—Ç –≤–∏—Å–∏—Ç –Ω–∞ ArenaLoaderScene.

–°—Ä–∞–∑—É –ø–æ—Å–ª–µ —Å—Ç–∞—Ä—Ç–∞ –≤—ã–∑—ã–≤–∞–µ—Ç /users/me.

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç licenseLeftSeconds:

0 ‚Üí –ª–∏—Ü–µ–Ω–∑–∏—è –∞–∫—Ç–∏–≤–Ω–∞ ‚Üí –≥—Ä—É–∑–∏–º ArenaScene.

0 –∏–ª–∏ –º–µ–Ω—å—à–µ ‚Üí –ª–∏—Ü–µ–Ω–∑–∏—è –∫–æ–Ω—á–∏–ª–∞—Å—å ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –≤ LoginScene.

üéÆ –°—Ü–µ–Ω—ã

LoginScene

UI –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

–ü–æ–ª—è –ª–æ–≥–∏–Ω–∞/–ø–∞—Ä–æ–ª—è + –∫–Ω–æ–ø–∫–∞ "–í–æ–π—Ç–∏".

–°–∫—Ä–∏–ø—Ç LoginManager.

ArenaLoaderScene

–°—Ü–µ–Ω–∞-–ø–æ—Å—Ä–µ–¥–Ω–∏–∫.

–°–∫—Ä–∏–ø—Ç GameManager –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ª–∏—Ü–µ–Ω–∑–∏—é.

ArenaScene

–¢–≤–æ—è VR-–∞—Ä–µ–Ω–∞.

–ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ª–∏—Ü–µ–Ω–∑–∏—è –∞–∫—Ç–∏–≤–Ω–∞.

üîÑ –ü–æ—Ç–æ–∫ —Ä–∞–±–æ—Ç—ã

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –∏–≥—Ä—É ‚Üí LoginScene.

–í–≤–æ–¥–∏—Ç –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å ‚Üí /login.

–°–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:

{
  "token": "JWT...",
  "user": { "username": "testLuna", "isAdmin": 0 }
}


‚Üí Unity —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ–∫–µ–Ω.

–ü–µ—Ä–µ—Ö–æ–¥ –≤ ArenaLoaderScene.

Unity –≤—ã–∑—ã–≤–∞–µ—Ç /users/me.

–°–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:

{
  "id": 9,
  "username": "testLuna",
  "isAdmin": false,
  "licenseEndDate": 1756224974529,
  "licenseLeftSeconds": 84307,
  "licenseLeftDays": 1
}


‚Üí –ï—Å–ª–∏ licenseLeftSeconds > 0 ‚Üí –≥—Ä—É–∑–∏–º –∞—Ä–µ–Ω—É.
‚Üí –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –≤ LoginScene.

–í–∞–∂–Ω–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

–í—Å–µ —Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç —á–µ—Ä–µ–∑ UnityWebRequest.

–ù—É–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å TextMeshPro –¥–ª—è UI (usernameField, passwordField, resultText).

–°–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ –∏–ª–∏ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç (–ø–æ—Ä—Ç—ã –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–∫—Ä—ã—Ç—ã).

–í –±–∏–ª–¥–µ –¥–ª—è Oculus/VRChat –Ω—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ä–∞–∑—Ä–µ—à–µ–Ω—ã —Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ —Ç–≤–æ–µ–º—É IP/–¥–æ–º–µ–Ω—É.


üîÑ –°—Ü–µ–Ω–∞—Ä–∏–π —Ä–∞–±–æ—Ç—ã

LoginScene ‚Äî UI —Å –ø–æ–ª—è–º–∏ –≤–≤–æ–¥–∞ (TMP_InputField usernameField, passwordField) –∏ –∫–Ω–æ–ø–∫–æ–π "–í–æ–π—Ç–∏" ‚Üí —Å–∫—Ä–∏–ø—Ç LoginManager.

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ ‚Üí –∑–∞–≥—Ä—É–∑–∫–∞ ArenaLoaderScene.

–í ArenaLoaderScene –≤–∏—Å–∏—Ç GameManager, –æ–Ω –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ /users/me.

–ï—Å–ª–∏ –ª–∏—Ü–µ–Ω–∑–∏—è –µ—â—ë –∞–∫—Ç–∏–≤–Ω–∞ ‚Üí –≥—Ä—É–∑–∏–º ArenaScene (—Ç–≤–æ—è VR-–∞—Ä–µ–Ω–∞).

–ï—Å–ª–∏ –∏—Å—Ç–µ–∫–ª–∞ ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –≤ LoginScene.



üîë –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ö–æ–¥–∞

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å ‚Üí —Å–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JWT-—Ç–æ–∫–µ–Ω.

Unity —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —ç—Ç–æ—Ç —Ç–æ–∫–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ PlayerPrefs.SetString("token", ...)).

–ü—Ä–∏ —Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—É—Å–∫–∞—Ö:

Unity –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –µ—Å—Ç—å –ª–∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω.

–ï—Å–ª–∏ –æ–Ω –µ—Å—Ç—å ‚Üí —Å—Ä–∞–∑—É –≤—ã–∑—ã–≤–∞–µ—Ç /users/me —Å —ç—Ç–∏–º —Ç–æ–∫–µ–Ω–æ–º.

–ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ —Ç–æ–∫–µ–Ω –≤–∞–ª–∏–¥–Ω—ã–π –∏ –ª–∏—Ü–µ–Ω–∑–∏—è –∞–∫—Ç–∏–≤–Ω–∞ ‚Üí —Å—Ä–∞–∑—É –≥—Ä—É–∑–∏—Ç—Å—è –∞—Ä–µ–Ω–∞.

–ï—Å–ª–∏ —Ç–æ–∫–µ–Ω –ø—Ä–æ—Å—Ä–æ—á–µ–Ω/–Ω–µ–≤–∞–ª–∏–¥–µ–Ω ‚Üí –∏–≥—Ä–æ–∫–∞ –∫–∏–¥–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ –≤ LoginScene, –≥–¥–µ –æ–Ω –∑–∞–Ω–æ–≤–æ –≤–≤–æ–¥–∏—Ç –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å.